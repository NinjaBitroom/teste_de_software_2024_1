<!--
Claudinei de Oliveira - pt-BR - 19-06-2023
Adaptado de Giridhar, 2016
O arquivo novo.html - todas as classes são do bootstrap -->

<!-- Estende o layout base.html -->
{% extends 'base.html' %}

<!-- Início do bloco head, que substituirá o bloco head em base.html -->
{% block head %}
    <!-- Define o título da página -->
    <title>Adicionar Novo Cliente</title>
{% endblock %}

<!-- Início do bloco body, que substituirá o bloco body em base.html -->
{% block body %}
    <!-- Define o cabeçalho da página -->
    <h3>Adicionar Novo Cliente</h3>

    <!-- Começa o bloco para exibir mensagens flash, se houver -->
    {% with messages = get_flashed_messages() %}
        <!-- Verifica se há mensagens para mostrar -->
        {% if messages %}
            <!-- Define a estrutura da mensagem, incluindo um botão para fechar a mensagem -->
            <div class="alert alert-warning alert-dismissible fade show" role="alert">
                <!-- Mostra a primeira mensagem flash -->
                {{ messages[0] }}
                <!-- Define o botão para fechar a mensagem -->
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endif %}
    {% endwith %}

    <!-- Define o formulário para adicionar um novo cliente -->
    <form action="{{ url_for('root.cliente.novo_cliente_post') }}" method="POST" autocomplete='off'>
        <div class='mb-3 d-flex align-items-center'>
            <label for='nome' class='form-label me-2'>Nome:</label>
            <input class='form-control' type='text' name='nome' id='nome' placeholder='Informe o Nome do cliente'
                   required autofocus/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='cpf' class='form-label me-2'>CPF:</label>
            <input class='form-control' type='text' name='cpf' id='cpf' placeholder='Informe o CPF do cliente'
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='logradouro' class='form-label me-2'>Logradouro:</label>
            <input class='form-control' type='text' name='logradouro' id='logradouro'
                   placeholder='Informe o logradouro do cliente' required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='numero' class='form-label me-2'>Número:</label>
            <input class='form-control' type='number' name='numero' id='numero' placeholder='Informe o número'
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='complemento' class='form-label me-2'>Complemento:</label>
            <input class='form-control' type='text' name='complemento' id='complemento'
                   placeholder='Informe o complemento' required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='bairro' class='form-label me-2'>Bairro:</label>
            <input class='form-control' type='text' name='bairro' id='bairro' placeholder='Informe o bairro do cliente'
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='cep' class='form-label me-2'>CEP:</label>
            <input class='form-control' type='text' name='cep' id='cep' placeholder='Informe o CEP do cliente'
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='cidade' class='form-label me-2'>Cidade:</label>
            <input class='form-control' type='text' name='cidade' id='cidade' placeholder='Informe a cidade do cliente'
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='uf' class='form-label me-2'>UF:</label>
            <input class='form-control' type='text' name='uf' id='uf' placeholder='Informe a UF do estado' maxlength="2"
                   required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='telefone' class='form-label me-2'>Telefone:</label>
            <input class='form-control' type='tel' name='telefone' id='telefone'
                   placeholder='Informe o telefone do cliente' required/>
        </div>

        <div class='mb-3 d-flex align-items-center'>
            <label for='email' class='form-label me-2'>Email:</label>
            <input class='form-control' type='email' name='email' id='email' placeholder='Informe o e-mail do cliente'
                   required/>
        </div>


        <!-- Define o botão para enviar o formulário -->
        <div class='mb-3'>
            <button type='submit' class='btn btn-primary mb-3'>Cadastrar</button>
        </div>
    </form>

    <!-- Define o cabeçalho para a lista de clientes -->
    <h3>Clientes Cadastrados</h3>

    <!-- Define a tabela para mostrar os clientes cadastrados -->
    <table class="table">
        <!-- Define o cabeçalho da tabela -->
        <thead>
        <tr>
            <th>Nome</th>
            <th>CPF</th>
            <th>Logradouro</th>
            <th>Numero</th>
            <th>Complemento</th>
            <th>Bairro</th>
            <th>Cep</th>
            <th>Cidade</th>
            <th>UF</th>
            <th>Telefone</th>
            <th>#</th>
        </tr>
        </thead>
        <!-- Define o corpo da tabela -->
        <tbody>
        <!-- Loop para cada cliente na lista de clientes -->
        {% for cliente in clientes %}
            <tr>
                <td>{{ cliente.nome }}</td>
                <td>{{ cliente.cpf }}</td>
                <td>{{ cliente.logradouro }}</td>
                <td>{{ cliente.numero }}</td>
                <td>{{ cliente.complemento }}</td>
                <td>{{ cliente.bairro }}</td>
                <td>{{ cliente.cep }}</td>
                <td>{{ cliente.cidade }}</td>
                <td>{{ cliente.uf }}</td>
                <td>{{ cliente.telefone }}</td>

                <td><a href="{{ url_for('root.cliente.editar_cliente_get', id=cliente.id) }}"
                       class="btn btn-primary btn-sm">Editar</a>
                </td>

                <!-- Exibe um link para deletar o cliente -->
                <td><!-- Link para a rota deletar_cliente, passando o id do cliente -->
                    <a href_to_confirm_first="{{ url_for('root.cliente.deletar_cliente', id=cliente.id) }}"
                       class="btn btn-danger btn-sm removerCliente">Deletar</a>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}

{% block script %}
    <script>
        let listaRemoveButton = document.querySelectorAll(".removerCliente");

        listaRemoveButton.forEach(item => {
            item.addEventListener("click", () => {
                if (confirm("Tem certeza que deseja excluir esse cliente?")) {
                    window.location.href = item.getAttribute("href_to_confirm_first");
                }
            })
        })

    </script>
{% endblock script %}
